var bkData;var isB2b=(window.location.hostname.indexOf("goibibobusiness")===-1)?false:true;gi.status={initDoc:function(){try{this.pushPrdctArrayToGap()}catch(f){}var d=Date();var c=d.split(" ")[2]+" "+d.split(" ")[1]+"'"+(d.split(" ")[3]).split("")[2]+(d.split(" ")[3]).split("")[3];$(".book_date").html(c);$(".dateLoader").hide();$(".odometer").hide();var b=$("#queryString").val().split("-")[8];var a="";if(b=="E"){a="- Economy"}else{if(b=="B"){a="- Business"}else{if(b=="F"){a="- First Class"}else{if(b=="W"){a="- Premium Economy"}}}}$(".seatingClass").html(a);if($("#gi_status").val()!="failed"&&$("#gi_status").val()!="canceled"){this.statusCheck()}},getError:function(a){},showPopup:function(a){$(".popOverlay").removeClass("dn");$(".popOverlay").addClass("popShow");$(".popOverlay").addClass("db");$("#"+a+".popModal").addClass("popShow")},getPrdctArrayForGTM:function(){try{var m=JSON.parse(gi.utils.getCookie("user_recent_search"))["air"][0]["query"].split("-");var a=[];if(flightType==="multicity"||flightType==="international"){var n="",i="",g="flight|";if(bkData[0].of[0].fl.length>0){var h=bkData[0].of[0].fl;if(h.length>1){n=m[1]+"-"+m[2]+"|"}for(var d=0;d<h.length;d++){if(d>0){n+="|";i+="|";g+="|"}n+=h[d].fr.toUpperCase()+"-"+h[d].to.toUpperCase();i+=h[d].an.split(" ").join("");g+=h[d].cr+"-"+h[d].fn+"|"+h[d].dt+"|"+h[d].fr.toUpperCase()+"_"+h[d].to.toUpperCase()}var h=bkData[0].of[0].rfls?bkData[0].of[0].rfls.fl:[];for(var c=0;c<h.length;c++){n+="|";i+="|";g+="|";n+=h[c].fr.toUpperCase()+"-"+h[c].to.toUpperCase();i+=h[c].an.split(" ").join("");g+=h[c].cr+"-"+h[c].fn+"|"+h[c].dt+"|"+h[c].fr.toUpperCase()+"_"+h[c].to.toUpperCase()}}var b="flight|";if(flightType==="multicity"){b+="MultiCity"}else{if(bkData[0].of[0].rfls){b+="InternationalRoundTrip"}else{if(bkData[0].of[0].multi_airline){b+="MultiOnward"}else{b+="Onward"}}}prdctImpression={id:g,brand:i,category:"flight_international",name:"flight|"+n,price:bkData[0].of[0].fd.tf,variant:b,quantity:(parseInt(m[5])+parseInt(m[6])+parseInt(m[7]))};a.push(prdctImpression)}else{var n="",i="",g="flight|";var h=bkData[0].of[0].fl;if(h.length>1){n=m[1]+"-"+m[2]+"|"}for(var d=0;d<h.length;d++){if(d>0){n+="|";i+="|";g+="|"}n+=h[d].fr.toUpperCase()+"-"+h[d].to.toUpperCase();i+=h[d].an.split(" ").join("");g+=h[d].cr+"-"+h[d].fn+"|"+h[d].dt+"|"+h[d].fr.toUpperCase()+"_"+h[d].to.toUpperCase()}a=[{id:g,brand:i,category:"flight_"+flightType,name:"flight|"+n,price:bkData[0].of[0].fd.tf,variant:(bkData[0].of[0].multi_airline&&bkData[0].of[0].multi_airline==="y"?"flight|MultiOnward":"flight|Onward"),quantity:(parseInt(m[5])+parseInt(m[6])+parseInt(m[7]))}];if(bkData.length>1&&bkData[1].rf){var h=bkData[1].rf[0];var n="",i="",g="flight|";if(h.fl.length>1){n=m[2]+"-"+m[1]+"|"}for(var d=0;d<h.fl.length;d++){if(d>0){n+="|";i+="|";g+="|"}n+=h.fl[d].fr.toUpperCase()+"-"+h.fl[d].to.toUpperCase();i+=h.fl[d].an.split(" ").join("");g+=h.fl[d].cr+"-"+h.fl[d].fn+"|"+h.fl[d].dt+"|"+h.fl[d].fr.toUpperCase()+"_"+h.fl[d].to.toUpperCase()}var l={id:g,brand:i,category:"flight_"+flightType,name:"flight|"+n,price:h.fd.tf,variant:(h.multi_airline&&h.multi_airline==="y"?"flight|MultiReturn":"flight|Return"),quantity:(parseInt(m[5])+parseInt(m[6])+parseInt(m[7]))};a.push(l)}}return a}catch(f){}},pushPrdctArrayToGap:function(){try{var a=this.getPrdctArrayForGTM();var c=JSON.parse($("#gi_status_new").val());dataLayer.push({ecommerce:{purchase:{actionField:{id:c[0]["transactionid"],affiliation:"goibibo",revenue:c[0]["transactamount"],tax:"",shipping:"",coupon:$("gi_promo_code").val()},products:a}},event:"enhanced-ecommerce-thankyou",path:location.pathname})}catch(b){gi.tracking.analyticsPush({eventType:"c",typeofClick:"A",siteLevel:1,details:{customLabel:"TXN Error GAP"+b,}});gi.utils.gapEventTracking("Thank you page data pushing failure","pushing failure","pushing_failure_reason"+err,"")}},statusCheck:function(c,a){var f=$("#gi_flavour").val();var e=$.param({fmnid:$("#gi_fmnid").val(),udf2:$("#gi_udf2").val()});var d="";if($("#gi_check").val()=="ammended"){d="/searchfmn/"+$("#gi_fmnid").val()+"/?check=ammended"}else{if(f==="citi"||isB2b){d="/flight-getstatus/";e=$.param({fmnid:$("#gi_fmnid").val()})}else{var b=$("#gi_hulk_host").val();d=b+"/status-call/";e=$.param({obj_id:$("#gi_fmnid").val()})}}$.ajax({type:"POST",url:d,data:e,success:this.getStatus});if($("#gi_fmnid_multi").val()){var e=$.param({fmnid:$("#gi_fmnid_multi").val(),udf2:$("#gi_udf2").val()});$.ajax({type:"POST",url:d,data:e,})}},openPassport:function(b){var a="/updatepassport/"+b+"/";$.ajax({type:"POST",url:a,success:gi.status.updatePassport});return false},updatePassport:function(f){var b=f;var a=new Date();var c=a.getFullYear();var e=new Date(b.tdate);$("#gi_showdetails")[0].innerHTML='<div id="gi_showUpdatePassport">'+(_.template($("#gi_updatepassport").html()))({respdata:b.details,bookingid:b.bookingid,pax:b.pax,is_insurance_required:f.is_insurance_required,is_passport_required:f.is_passport_required,is_inbound_insurance:f.is_inbound_insurance})+"</div>";$(".birthdate").datepicker({beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",99999999999999)},0)},dateFormat:"dd/mm/yy",changeMonth:true,changeYear:true,yearRange:"1910:"+c,maxDate:a});$(".issuedate").datepicker({beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",99999999999999)},0)},dateFormat:"dd/mm/yy",changeMonth:true,changeYear:true,maxDate:a});$(".expirydate").datepicker({beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",99999999999999)},0)},dateFormat:"dd/mm/yy",changeMonth:true,changeYear:true,minDate:e});for(var d=0;d<b.details.length;d++){if(b.details[d].VisaType!="Visa Type"){$("#visatype"+d).attr("disabled",true)}}for(var d=0;d<b.details.length;d++){if(b.details[d].Nationality!="Issuing Country"){$(".national:eq("+d+") option[value="+b.details[d].Nationality+"]").attr("selected","selected");$($(".national")[d]).attr("disabled",true)}}gi.status.showPopup("upPass");$("#updatepassportbutton").click(function(){gi.status.updateDetails(f);return false})},updateDetails:function(e){var d=$("#pax_count").val();var c=[];var a=false;var f=e.is_inbound_insurance;for(var b=0;b<d;b++){if($.trim($("#passport"+b).val())===""||$("#dateofissue"+b).val()==""||$("#dateofexpiry"+b).val()==""||$("#dateofbirth"+b).val()==""||$.trim($("#placeofissue"+b).val())==""||$("#nationality"+b).val()==""){a=true}if(f==true){if($.trim($("#rti_nominee"+b).val())===""||$.trim($("#rti_nominee_rel"+b).val())===""){a=true}}if(a==true){$("#parent_pass_error").removeClass("dn");$("#pass_error")[0].innerHTML="Please fill all the fields";return}else{$("#parent_pass_error").addClass("dn")}c.push($($(".national")[b]).val())}$("#traveller_nationality").val(c);$.ajax({type:"POST",url:"/updatepassportform/",data:$("#traveller_passport").serialize(),success:this.showupdateSuccess});$("#pass_loader").removeClass("dn")},showupdateSuccess:function(e){gi.utils.closePopup();var d="updated successfully</br>";$("#gi_reschedCancelCommonDialogContent").dialog("close");$("#process_mess").dialog("close");$("#gi_reschedCancelCommonDialogContent")[0].innerHTML=d;if(e.insurance_list.length>=1){var c=false;var a=false;for(var b=0;b<e.insurance_list.length;b++){if(e.insurance_list[b].downloadpath==false){a=true}else{c=true}}$("#gi_reschedCancelCommonDialogContent")[0].innerHTML=(_.template($("#gi_insurance_list").html()))({insuredPaxs:e.insurance_list});if(a==false){$(".passportsubhead")[0].innerHTML="Congratulations, your insurance policies are emailed to your  registered email id. Please find policy link below as well."}else{if(a==true&&c==true){$(".passportsubhead")[0].innerHTML="Congratulations, your insurance policies are emailed to your  registered email id.</br> However, we are unable to issue insurance for people whose age is more than 70 years or less than 3 months </br> hence, we have triggered the refund of insurance amount for the same.</br>Please contact insurance company directly for a suitable insurance plan."}else{if(a==true&&c==false){$(".passportsubhead")[0].innerHTML="Apologies, we are unable to issue insurance </br> Please contact insurance company directly for a suitable insurance plan. We have triggered refund of insurance amount to you."}}}}$("#gi_reschedCancelCommonDialogContent").dialog({modal:true,buttons:{Ok:function(){$(this).dialog("close");$(".tu_passport").addClass("dn");$(".tu_insurance").addClass("dn");$(".tu_manualint").removeClass("dn");$(".gsfl").each(function(){if(e.insurance_list.length>=1){$(this).html("Manual")}else{$(this).html("Airline Confirmation Awaited")}});$(".passportwrp").each(function(){$(this).hide()});$(".rti_ins_msg").each(function(){$(this).hide()});$(".icon-passport").hide();$(".passport-icon-text").hide()}}})},getStatus:function(k){$("#ajaxLoader").attr("class","dn");var b=k;if(typeof k!=="object"){b=JSON.parse(k)}if(b.st!=="farejump"){$(".tu_partial").addClass("dn")}$(".tu_"+b.st).removeClass("dn");if(b.st=="error"){gi.status.show_booking_failed_timer();$(".ticketBox").addClass("opaPartial");$(".innerCenter").hide();$("#gi_statscont").attr("class","dn");$("#why_error").removeClass("dn")}if(b.st=="success"||b.st=="passport"||b.st=="insurance"||b.st=="manualint"||b.st=="manual"){$("#renderflights").html(b.html);$("#whatnext").removeClass("dn");var a=Date();var f=a.split(" ")[2]+" "+a.split(" ")[1]+"'"+(a.split(" ")[3]).split("")[2]+(a.split(" ")[3]).split("")[3];$(".book_date").html(f);$(".dateLoader").hide();$(".pnrLoader").hide();$(".timeLoader").hide();$(".odometer").show();$(".digit-ten").removeClass("digit-ten");$(".digit-one").removeClass("digit-one");var j=$("#time_taken").val();var d=j.split("");$(".digOne").html(d[0]);$(".digTwo").html(d[1]);$(".digThree").html(d[3]);$(".digFour").html(d[4]);$(".timerPos").show()}else{if(b.st=="farejump"){var c=$("#gi_hulk_host").val();url=c+"/farejump/";$.ajax({type:"POST",url:url,contentType:"application/x-www-form-urlencoded",data:{paymentid:$("#gi_fmnid").val()},success:function(e){$(".tu_partial").addClass("dn");$(".ticketBox").addClass("opaPartial");$(".tu_farejump").html(e.data)},error:function(e){}})}}var h=$("#queryString").val().split("-")[8];var i="";if(h=="E"){i="- Economy"}else{if(h=="B"){i="- Business"}else{if(h=="F"){i="- First Class"}else{if(h=="W"){i="- Premium Economy"}}}}$(".seatingClass").html(i);window.paymentResp=b;try{dataLayer.push({cdCatQuery:"flight_"+(flightType==="domestic"?"domestic":"international"),cdSubCatQuery:getSubCat(),cdFlightSearchOrigin:qryArr[1],cdFlightSearchDestination:qryArr[2],cdFlightSearchDeparture:qryArr[3]&&qryArr[3].replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"),cdFlightSearchReturnDate:qryArr[4]&&qryArr[4].replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"),cdFlightSearchTravellers:travellerDetails,cdFlightSearchClass:"",event:"",userid:getUserId(),cdFlightDiscountedRoundTrip:getDiscountedTrip(),dpFltPax:(qryArr[5]+"-"+qryArr[6]+"-"+qryArr[7]),dpTimestamp:new Date().toString(),dpPageName:"FlightsThankYouPage"})}catch(g){}},hotelFlightReco:function(){try{var c=JSON.parse($("#gi_extraData").val());for(var d=0;d<c.length;d++){if("origin" in c[d]){var j=c[d]["arrdate"].split("t")[0];var a=c[d]["origin"];if(c[d]["onwardflights"].length==0){var k=c[d]["destination"]}else{var k=c[d]["onwardflights"][c[d]["onwardflights"].length-1]["destination"]}var f=c[d]["fare"]["adulttotalfare"];break}}var g=$("#gi_backend_url").val();var b=(g!="")?giProtocol+g+"/gethotelflightreco/?url="+window.location.href:"/";var m=gi.utils.createCORSRequest("POST",b);if(!m){return}m.onload=this.drawReco;m.onerror=function(){};var l="qtype=fbs&src="+a+"&dest="+k+"&userprice="+f+"&deptime="+j;m.send(l)}catch(h){}},drawReco:function(j){try{var d=new Array();var a=JSON.parse(j.currentTarget.responseText);var g={cleartrip:"HTLCLR",desiya:"HTLDSY",ingoibibo:"HTLGBO"};var b=true;for(var c in a){b=false;data=a[c];city=data[10];d.push("<div id='gi_mid_in'><div class='ghr_wrap'><h3>Hotel Recommendations in "+city+"</h3><small>goibibo hotel recommendation algorithms is based on user reviews, prices, spending habits</small><ul class='ghr_list'>");break}if(b==true){return}var f=0;for(var k in a){data=a[k];schkey=data[0];vendor=schkey.split(":")[2];hotel_id=schkey.split(":")[0];name=data[1];room_type=data[2];price=data[3];chkin=data[4];chkout=data[5];reviews=data[6];img=data[7];address=data[8];adv_rating=data[9];city=data[10];rating=parseInt(k);booking_details_url="http://www.goibibo.com/hotels/product/hotels-"+city+"-"+chkin+"-"+chkout+"-1-2_0/"+g[vendor]+hotel_id+"/?v=v1";adv_details_url="http://www.goibibo.com/hotels/product/hotels-"+city+"-"+chkin+"-"+chkout+"-1-2_0/"+g[vendor]+hotel_id+"/?t=3&v=v1";if(f%2==0){d.push("<div style='clear: both'></div>")}d.push("<li><a href='"+booking_details_url+"' target='_blank' class='ghr_img'><img src='"+img+"' alt='' /></a><div class='ghr_desc'><span><a href='"+booking_details_url+"' class='ghr_name' target='_blank'>"+name+"</a>");d.push("<span class='srate_wrap'>");for(var c=0;c<rating;c++){d.push("<i class='ghr_srating'></i>")}d.push("</span></span>");d.push("<em>Rs."+price+"</em><small>"+room_type+"</small><br/><small>(per room per night)</small>");if(adv_rating!="0"){d.push("<p class='ghr_review'><dfn>Review:</dfn><span><img src='http://www.tripadvisor.com/img/cdsi/img2/ratings/traveler/"+adv_rating+"-15797-4.gif' alt=''/></span><a href='"+adv_details_url+"' target='_blank'> "+reviews+" reviews</a></p>")}d.push("<address>"+address+"</address>");d.push("</div></li>");f=f+1}d.push("</ul></div></div>");html_text=d.join("");$("#hotel_reco").html(html_text)}catch(h){}},getEasycab:function(){$("#gi_easycab").attr("class","db");$("#gi_easycab").dialog({width:750,modal:true,buttons:{}})},getEasycabSuccess:function(b){$("#gi_easycab").dialog("close");$("#cabsuccess").attr("class","done");$("#cabbook").attr("class","dn");var a="/cab/cabpostbook/?fmnid="+b;$("#dialog-tex").attr("src",a);$("#gi_easyc").dialog({title:"Cab Booking Successful",width:750,height:"auto",modal:true,buttons:{}})},show_booking_failed_timer:function(b){var a=(b||{}).waitTime||30;$("#booking-countdown").countdown("destroy");$("#booking-failure-timer-container").removeClass("dn");$("#booking-countdown").countdown({until:new Date(new Date().getTime()+a*60000),format:"MS",layout:"<b>{mnn}:{snn} minutes {desc}</b>",onExpiry:function(){$("#booking-failure-timer-container").addClass("dn");$("#booking-recovery-expired-msg").dialog({width:500,modal:true,height:"auto"})}})}};$(document).ready(function(){try{bkData=JSON.parse(gi.utils.getCookie("gapData"));var c=$("#gi_flavour").val();window.addEventListener("beforeunload",function a(){navigator.sendBeacon("https://dexter.goibibo.com/common/multi-newrelic",JSON.stringify({dataLayer:window.dataLayer,serviceApp:"fore-flights",vertical:"flights",flavour:c}))})}catch(b){}gi.status.initDoc()});function getSubCat(){try{if(!bkData){bkData=JSON.parse(gi.utils.getCookie("gapData"))}var a="";if(flightType==="multicity"){a="multicity"}else{if(bkData.length===1){a="Oneway";if(bkData[0].of[0].multi_airline&&bkData[0].of[0].multi_airline==="y"){a="Multi"}}else{a="Roundtrip";var b=bkData[1].rf[0];if(bkData[0].of[0].multi_airline&&bkData[0].of[0].multi_airline==="y"&&b.multi_airline&&b.multi_airline==="y"){a="MultiOWRT"}else{if(b.multi_airline&&b.multi_airline==="y"){a="MultiRT"}else{if(bkData[0].of[0].multi_airline&&bkData[0].of[0].multi_airline==="y"){a="MultiOW"}}}}}return a}catch(c){}}function getDiscountedTrip(){try{if(!bkData){bkData=JSON.parse(gi.utils.getCookie("gapData"))}if((bkData[0].of[0].dis!==undefined&&bkData[0].of[0].dis==="true")||(bkData[1]&&bkData[1].rf[0].dis!==undefined&&bkData[1].rf[0].dis==="true")){return true}return false}catch(a){}}function getUserId(){try{return gi.userObject.userinfo.userid}catch(a){}};